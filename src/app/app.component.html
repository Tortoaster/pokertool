<main>
  @if (connecting) {
    <div class="center">
      <app-throbber/>
    </div>
  } @else {
    <div class="slots">
      @for (_ of Array(state.numPlayers); track $index) {
        <div class="slot">
          @if ($index < state.playedCards.length) {
            <app-card [value]="state.playedCards[$index]" [flipped]="!(state.revealed || state.playedBy[$index] == userService.getUser())" />
          }
        </div>
      }
    </div>


    <div class="button-bar">
      @if (state.host) {
        <app-button (onClick)="revealConceal()" [disabled]="synchronizing || connecting">
          @if (state.revealed) { Hide } @else { Reveal }
        </app-button>
        <app-button (onClick)="reset()" [disabled]="synchronizing || connecting">
          Reset
        </app-button>
      }
      @if(spectating()) {
      <app-button (onClick)="join()" [disabled]="synchronizing || connecting">
        Join
      </app-button>
      } @else {
      <app-button (onClick)="spectate()" [disabled]="synchronizing || connecting">
        Spectate
      </app-button>
      }
    </div>

    <div class="hand" [class.hidden]="state.revealed || connecting || spectating()">
      <app-hand (cardChange)="playCard($event)" [disabled]="synchronizing || state.revealed || connecting" [hidden]="state.revealed || connecting"/>
    </div>
  }
</main>

<router-outlet/>
